<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.7.4 at 2018-01-09 
 | Rendered using Apache Maven Fluido Skin 1.6
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20180109" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Alternet Security &#x2013; Authentication Formats</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.6.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
      <script type="text/javascript" src="./js/apache-maven-fluido-1.6.min.js"></script>
      </head>
    <body class="topBarEnabled">
      <div id="topbar" class="navbar navbar-fixed-top ">
      <div class="navbar-inner">
            <div class="container"><div class="nav-collapse">
            <ul class="nav">
        <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Main <b class="caret"></b></a>
        <ul class="dropdown-menu">
            <li><a href="../" title="Home">Home</a></li>
            <li><a href="https://github.com/alternet/alternet.ml" title="GitHub project">GitHub project</a></li>
            <li><a href="http://semantic-mismatch.blogspot.fr/" title="Blog">Blog</a></li>
            <li><a href="../release-notes.html" title="Release notes">Release notes</a></li>
        </ul>
      </li>
        <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Download <b class="caret"></b></a>
        <ul class="dropdown-menu">
            <li><a href="../download.html" title="Download">Download</a></li>
            <li><a href="../license.html" title="License">License</a></li>
        </ul>
      </li>
        <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation <b class="caret"></b></a>
        <ul class="dropdown-menu">
            <li><a href="../parsing/index.html" title="Alternet Parsing">Alternet Parsing</a></li>
            <li><a href="../scanner/index.html" title="Alternet Scanner">Alternet Scanner</a></li>
            <li><a href="../security/index.html" title="Alternet Security">Alternet Security</a></li>
            <li><a href="../tools/index.html" title="Alternet Tools">Alternet Tools</a></li>
            <li><a href="../tools-generator/index.html" title="Alternet Tools - Generator">Alternet Tools - Generator</a></li>
        </ul>
      </li>
        <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Maven reports <b class="caret"></b></a>
        <ul class="dropdown-menu">
            <li class="dropdown-submenu">
<a href="project-info.html" title="Project Information">Project Information</a>
              <ul class="dropdown-menu">
                  <li><a href="project-summary.html" title="Summary">Summary</a></li>
                  <li><a href="license.html" title="Licenses">Licenses</a></li>
                  <li><a href="team-list.html" title="Team">Team</a></li>
                  <li><a href="source-repository.html" title="Source Code Management">Source Code Management</a></li>
                  <li><a href="issue-tracking.html" title="Issue Management">Issue Management</a></li>
                  <li><a href="dependencies.html" title="Dependencies">Dependencies</a></li>
                  <li><a href="dependency-convergence.html" title="Dependency Convergence">Dependency Convergence</a></li>
                  <li><a href="plugins.html" title="Plugins">Plugins</a></li>
              </ul>
            </li>
            <li class="dropdown-submenu">
<a href="project-reports.html" title="Project Reports">Project Reports</a>
              <ul class="dropdown-menu">
                  <li><a href="xref/index.html" title="Source Xref">Source Xref</a></li>
                  <li><a href="xref-test/index.html" title="Test Source Xref">Test Source Xref</a></li>
                  <li><a href="failsafe-report.html" title="Failsafe Report">Failsafe Report</a></li>
                  <li><a href="surefire-report.html" title="Surefire Report">Surefire Report</a></li>
                  <li><a href="cpd.html" title="CPD">CPD</a></li>
                  <li><a href="pmd.html" title="PMD">PMD</a></li>
                  <li><a href="checkstyle.html" title="Checkstyle">Checkstyle</a></li>
              </ul>
            </li>
        </ul>
      </li>
              </ul>
                    <ul class="nav pull-right">
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">External Links <b class="caret"></b></a>
                <ul class="dropdown-menu">
    <li><a href="https://github.com/alternet/alternet.ml" title="GitHub project">GitHub project</a></li>
    <li><a href="../demo.html" title="Other Demos">Other Demos</a></li>
                </ul>
              </li>
            </ul>
            </div>
        </div>
      </div>
    </div>
    <div class="container">
      <div id="banner">
        <div class="pull-left"><a href="../../security-auth/security-auth.html" id="bannerLeft"><h2>Alternet Security - Authentication</h2>
</a></div>
        <div class="pull-right"></div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2018-01-09<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 1.0<span class="divider">|</span></li>
        <li class=""><a href="../.." title="Alternet">Alternet</a><span class="divider">»</span></li>
      <li class=""><a href="../index.html" title="Alternet Libs">Alternet Libs</a><span class="divider">»</span></li>
      <li class=""><a href="../security/index.html" title="Alternet Security">Alternet Security</a><span class="divider">»</span></li>
      <li class=""><a href="index.html" title="Authentication">Authentication</a><span class="divider">»</span></li>
    <li class="active ">Authentication Formats</li>
        </ul>
      </div>
        <div id="bodyColumn" >
<h1>Authentication Formats</h1>

<ul>
  
<li>Description of popular crypt formats</li>
  
<li>Design considerations</li>
</ul>
<div class="section">
<h2><a name="Few_words_about_the_design"></a>Few words about the design</h2>
<p>For checking a password, most tools will get all the expected parameters, then compute a formatted crypt string, and compare it with the one stored in the database. Alternet Security is designed with a neat separation of concepts in mind : algorithms and their parameters, charsets, encodings, formattings, and crypt format families. It gives the advantage that you can combine them at will, and you&#x2019;ll have the same base code when, for example, you want to encode some bytes in a specific format. Everything work in the same way. Moreover, for checking a password, the parameters are extracted from the crypt stored in the database, the binary hash is isolated, and it is the value that will be compared to the password after hashing it, without formatting it. It sounds more natural to me. Conversely, most passwords checker libraries (not only in Java), will compare the result hash after encoding them : with an hexadecimal encoding, you certainly have to compare regardless the case, but with a base64 encoding, the case matters. This is why this framework only compare bytes.</p>
<p>Most of the description of the popular hash formats was largely inspired from the outstanding <a class="externalLink" href="http://passlib.readthedocs.io/en/stable/index.html">Passlib library for Python</a>.</p></div>
<div class="section">
<h2><a name="Crypt_formats"></a>Crypt formats</h2>

<div class="source">
<div class="source"><pre class="prettyprint linenums">Digest (md5) 3 colon delimited field, 32 character hash           admin:The Realm:11fbe079ed3476f7712030d24042ca35
SHA-1        {SHA} magic in hash, 33 characters total             admin:{SHA}QvQHx34cyGz2cjXj6cauQoAwtIg=
Crypt        (no magic) - 11 character hash                       admin:$cnhJ7swqUWTc
Apache MD5   $apr1$ magic in hash&lt;br /&gt;(Not supported by Foswiki) admin:$apr1$jgwedrkq$jzeetEHMGal5H0SUFDMEl1
crypt-MD5    $1$ magic in hash, 34 characters total               admin:$1$3iuE5z/b$JHyXMzQOIq3cl6WlEMoZC.
</pre></div></div></div>
<div class="section">
<h2><a name="Format_:_schemesaltcrypt"></a>Format : <tt>$[scheme]$[salt]$[crypt]</tt></h2>

<table border="0" class="table table-striped">
  <thead>
    
<tr class="a">
      
<th>ID</th>
      
<th>Method </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td>1 </td>
      
<td>MD5 with salt</td>
    </tr>
    
<tr class="a">
      
<td>2a</td>
      
<td>Blowfish&#x2014;&#x2013;</td>
    </tr>
    
<tr class="b">
      
<td>5 </td>
      
<td>SHA-256&#x2014;&#x2014;</td>
    </tr>
    
<tr class="a">
      
<td>6 </td>
      
<td>SHA-512&#x2014;&#x2014;</td>
    </tr>
  </tbody>
</table>
<div class="section">
<h3><a name="Examples"></a>Examples</h3>

<ul>
  
<li>Apache MD5 crypt format : <tt>$apr1$jgwedrkq$jzeetEHMGal5H0SUFDMEl1</tt></li>
  
<li>Crypt MD5 : <tt>$1$3iuE5z/b$JHyXMzQOIq3cl6WlEMoZC.</tt></li>
</ul>

<ul>
  
<li>Contains the password encoded to base64 (just like {SSHA}) : <tt>{SSHA.b64}986H5cS9JcDYQeJd6wKaITMho4M9CrXM</tt></li>
  
<li>Contains the password encoded to hexa : <tt>{SSHA.HEX}3f5ca6203f8cdaa44d9160575c1ee1d77abcf59ca5f852d1</tt></li>
</ul>

<ul>
  
<li>SSHA : Salted SHA</li>
</ul>
<p>Base64 encoded hash with salt userPassword: <tt>{SSHA}MTIzNDU2Nzg5MDEyMzQ1Njc4OTAxMjM0</tt></p>

<div class="source">
<div class="source"><pre class="prettyprint linenums">Base64 decoded value
     SHA1 Hash      Salt
--------------------++++
123456789012345678901234
</pre></div></div>
<p><a class="externalLink" href="http://tools.ietf.org/id/draft-stroeder-hashed-userpassword-values-01.html">http://tools.ietf.org/id/draft-stroeder-hashed-userpassword-values-01.html</a></p>

<div class="source">
<div class="source"><pre class="prettyprint linenums">SHA-1        {SHA} magic in hash, 33 characters total             admin:{SHA}QvQHx34cyGz2cjXj6cauQoAwtIg=
Crypt        (no magic) - 11 character hash                       admin:$cnhJ7swqUWTc
Apache MD5   $apr1$ magic in hash&lt;br /&gt;(Not supported by Foswiki) admin:$apr1$jgwedrkq$jzeetEHMGal5H0SUFDMEl1
crypt-MD5    $1$ magic in hash, 34 characters total               admin:$1$3iuE5z/b$JHyXMzQOIq3cl6WlEMoZC.
</pre></div></div>

<div class="source">
<div class="source"><pre class="prettyprint linenums">root:$1$hdhxObPx$TYFuTKsB9GGIgo53rF4bi1:0:0:root:/:/bin/sh
</pre></div></div>
<p>Crypt based password hashes have several parts separated by $</p>

<ul>
  
<li>The hash type, <tt>1</tt> in your case, this stands for MD5-crypt (this is not plain MD5)</li>
  
<li>The salt, <tt>hdhxObPx</tt> in your case</li>
  
<li>The actual hash <tt>TYFuTKsB9GGIgo53rF4bi1</tt> in your case</li>
  
<li>Some schemes have additional parameters, such as a work-factor, but this does not apply to the scheme used in your example.</li>
  
<li>The MD5-Crypt scheme should be avoided, in favor of modern schemes, such as bcrypt (usually starting with <tt>$2a$</tt>). Not because MD5 is cryptographically broken, but because it has a constant work-factor, that&#x2019;s too small for the computational power modern attackers can field</li>
</ul>
<div class="section">
<h4><a name="Crypt"></a>Crypt</h4>
<p>Encrypts a password in a crypt(3) compatible way. The exact algorithm depends on the format of the salt string:</p>

<ul>
  
<li>SHA-512 salts start with <tt>$6$</tt> and are up to 16 chars long.</li>
  
<li>SHA-256 salts start with <tt>$5$</tt> and are up to 16 chars long</li>
  
<li>MD5 salts start with <tt>$1$</tt> and are up to 8 chars long</li>
  
<li>DES, the traditional UnixCrypt algorithm is used with only 2 chars. Only the first 8 chars of the passwords are used in the DES algorithm !</li>
  
<li>The magic strings <tt>$apr1$</tt> and <tt>$2a$</tt> are not recognized by this method as its output should be identical with that of the libc implementation.</li>
  
<li>The rest of the salt string is drawn from the set <tt>[a-zA-Z0-9./]</tt> and is cut at the maximum length of if a <tt>$</tt> sign is encountered. It is therefore valid to enter a complete hash value as salt to e.g. verify a password with: <tt>storedPwd.equals(crypt(enteredPwd, storedPwd))</tt></li>
</ul>
<p>The resulting string starts with the marker string (<tt>$6$</tt>), continues with the salt value and ends with a <tt>$</tt> sign followed by the actual hash value.</p>
<p>For DES the string only contains the salt and actual hash. It&#x2019;s total length is dependent on the algorithm used:</p>

<ul>
  
<li>SHA-512: 106 chars</li>
  
<li>SHA-256: 63 chars</li>
  
<li>MD5: 34 chars</li>
  
<li>DES: 13 chars</li>
</ul>
<div class="section">
<h5><a name="Example:"></a>Example:</h5>

<div class="source">
<div class="source"><pre class="prettyprint linenums">      crypt(&quot;secret&quot;, &quot;$1$xxxx&quot;) =&gt; &quot;$1$xxxx$aMkevjfEIpa35Bh3G4bAc.&quot;
      crypt(&quot;secret&quot;, &quot;xx&quot;) =&gt; &quot;xxWAum7tHdIUw&quot;
</pre></div></div></div></div></div></div>
<div class="section">
<h2><a name="Hashers"></a>Hashers</h2>
<div class="section">
<h3><a name="Families"></a>Families</h3>
<p>3 families of hasher are supported :</p>

<ul>
  
<li>WorkFactorHasher (e.g. PBKDF2, Bcrypt, Scrypt) : salt + iteration (e.g. PBKDF2WithHmacSHA1)</li>
  
<li>SaltedHasher (e.g. SSHA, MD5Crypt, UNIX CRYPT)</li>
  
<li>SimpleHasher : w/o salt and iteration (e.g. MD5Plain)</li>
</ul></div>
<div class="section">
<h3><a name="MD5_Variants"></a>MD5 Variants</h3>

<ul>
  
<li>MD5Crypt (<tt>$1$</tt> and <tt>$apr1$</tt>)</li>
  
<li>MD5Plain (MD5 w/o salt)</li>
</ul></div>
<div class="section">
<h3><a name="BCrypt"></a>BCrypt</h3>
<p>Isolation of the scheme writing/parsing from the production of the crypt.</p></div></div>
<div class="section">
<h2><a name="CryptFormat"></a>CryptFormat</h2>
<p>We just need to parse the scheme :</p>

<ul>
  
<li><tt>scheme + ssp</tt></li>
  
<li><tt>ssp</tt> depends on the Hasher</li>
  
<li>The Hasher is built from the scheme</li>
  
<li>Some <tt>ssp</tt> must know whether there is a salt or an iterator in order to call the suitable hasher family</li>
  
<li>The Hasher can configure itself (e.g. BCrypt always use the base64 encoding and supply its own implementation</li>
</ul>

<ul>
  
<li>ModularCryptFormat must not process &#x201c;<i>&#x201c; or &#x201d;&#x201c; : we need a unix crypt format for &#x201d;&#x201c; (I don&#x2019;t know what for &#x201d;</i>&#x201d;) that may be passed as the very last CryptFormat</li>
</ul>

<ul>
  
<li>Crypt formats must be able to check the data size (SALT) in order to guess the rights parameters.</li>
</ul>
<p><a class="externalLink" href="http://forum.insidepro.com/viewtopic.php?t=8225">http://forum.insidepro.com/viewtopic.php?t=8225</a></p>
<h1>Binary</h1>
<p>Many base64 encodings are used across crypt formats :</p>

<table border="0" class="table table-striped">
  <thead>
    
<tr class="a">
      
<th>Name</th>
      
<th>Value space</th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td>BASE64_CHARS</td>
      
<td>&#x2018;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x2019;</td>
    </tr>
    
<tr class="a">
      
<td>HASH64_CHARS</td>
      
<td>&#x2018;./0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&#x2019;</td>
    </tr>
    
<tr class="b">
      
<td>BCRYPT_CHARS</td>
      
<td>&#x2018;./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#x2019;</td>
    </tr>
  </tbody>
</table>
<p>Sometimes, hashers are setting specific options :</p>

<ul>
  
<li>DES crypt : use a big-endian encoding ; this is rather taken in charge when producing the bytes</li>
  
<li>custom pbkdf2 hashes : BASE64_CHARS , except that it uses &#x2018;.&#x2019; instead of &#x2018;+&#x2019;, and omits trailing padding &#x2018;=&#x2019; and whitespace.</li>
</ul></div>
        </div>
    </div>
    <hr/>
    <footer>
      <div class="container">
        <div class="row">
            <p>Copyright &copy;2018
<a href="http://alternet.ml">Alternet</a>.
All rights reserved.</p>
        </div>
        <p id="poweredBy" class="pull-right">  <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
  </p>
        </div>
    </footer>
    </body>
</html>
